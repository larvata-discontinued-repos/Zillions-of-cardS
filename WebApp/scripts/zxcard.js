// Generated by CoffeeScript 1.6.3
$(function() {
  var AppView, CardDetailsView, CardList, CardListView, CardModel, FilterPanelModel, FilterPanelView, app, cardListView;
  _.each(dbMain, function(value, key) {
    var list;
    if (value.Version.length > 0) {
      value.Disabled = true;
    }
    list = _.filter(dbMain, function(obj) {
      return obj.CardName_Ch === value.CardName_Ch;
    });
    _.extend(value, {
      Relations: list
    });
    return _.extend(value, {
      Id: key
    });
  });
  FilterPanelModel = Backbone.Model.extend({
    defaults: {
      Keyword: '',
      Type: '',
      Colors: '',
      Cost: '',
      Cost_Method: '',
      Power: '',
      Power_Method: '',
      Icon: '',
      Race: '',
      CardSet: '',
      Rearity: '',
      Tags: ''
    }
  });
  FilterPanelView = Backbone.View.extend({
    initialize: function() {
      return this.model = new FilterPanelModel();
    },
    events: {},
    filterByKeywords: function() {}
  });
  CardDetailsView = Backbone.View.extend({
    el_s: '.main-card-summary',
    el_d: '.main-card-detail',
    template_s: _.template($('#cardSummaryTemplate').html()),
    template_d: _.template($('#cardDetailsTemplate').html()),
    initialize: function() {
      return this.render();
    },
    render: function() {
      $(this.el_s)[0].outerHTML = this.template_s({
        Card: this.model.toJSON()
      });
      $(this.el_d)[0].outerHTML = this.template_d({
        Card: this.model.toJSON()
      });
      return $('.zx-card-tabs li').click(function() {
        var tab;
        tab = $(this).data('tab');
        $('.zx-tab-pages div').hide();
        $(".zx-tab-pages div[data-tab=" + tab + "]").show();
        $('.zx-card-tabs li').removeClass('active');
        return $(".zx-card-tabs li[data-tab=" + tab + "]").addClass('active');
      });
    },
    renderByIndex: function(index) {}
  });
  CardListView = Backbone.View.extend({
    el: '.main-filter-result',
    template: _.template($('#cardListTemplate').html()),
    initialize: function() {
      this.collection = new CardList(dbMain);
      return this.render();
    },
    render: function() {
      this.$el.append(this.template({
        CardList: this.collection.toJSON()
      }));
      $('.main-filter-result a').click(function() {
        $('.main-filter-result a').removeClass('actived');
        return $(this).addClass('actived');
      });
      if (this.collection.length > 0) {
        return this.renderCardDetails();
      }
    },
    events: {
      "click a": "renderCardDetails"
    },
    renderCardDetails: function(event) {
      var cardDetailsView, ele, id, model;
      if (event != null) {
        ele = $(event.toElement).closest('a');
        id = ele.data("id");
      } else {
        id = 0;
      }
      model = this.collection.models[id];
      return cardDetailsView = new CardDetailsView({
        model: model
      });
    }
  });
  AppView = Backbone.View.extend({
    initialize: function() {
      return this.render;
    },
    render: function() {},
    displayCardDetails: function() {},
    filter: function() {}
  });
  CardModel = Backbone.Model.extend({
    defaults: {
      CardSet: '',
      CardColor_Ch: '',
      CardColor_En: '',
      SerialNo: '',
      Version: '',
      Img_Suffix: '',
      CardName_Jp: '',
      CardName_Ch: '',
      Rarity: '',
      Type: '',
      Race: '',
      Cost: 0,
      Power: 0,
      Icon: '',
      Ability_Ch: '',
      Ability_Jp: '',
      Description_Ch: '',
      Description_Jp: '',
      Neta: '',
      Relation: '',
      Illustrator: '',
      Tag: '',
      Nickname: '',
      Ruling: '',
      TsugKomi: '',
      Filtered: false,
      Disabled: false,
      Selected: false
    }
  });
  CardList = Backbone.Collection.extend({
    model: CardModel
  });
  cardListView = new CardListView();
  return app = new AppView();
});
